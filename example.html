<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/@editorjs/footnotes@latest"></script>
  <style>
    * {
      box-sizing: border-box;
    }
  </style>
  <script src="simple_image.js"></script>
  <script src="marker.js"></script>
  <script src="ruby.js"></script>
  <script src="example_table.js"></script>
  <link href="ruby.css" rel="stylesheet" />
  <link href="marker.css" rel="stylesheet" />
  <link href="simple_image.css" rel="stylesheet" />

  <div id="editorjs"></div>
  <button id="save-button">Save</button>
  <pre id="output"></pre>
  <script>
    const editor = new EditorJS({
      autofocus: true,
      tools: {
        simple_image: {
          class: SimpleImage,
          inlineToolbar: ['link', 'bold']
        },
        mark: Marker,
        ruby: Ruby,
        table: {
          class: Table,
          inlineToolbar: ['link', 'bold', 'ruby', 'marker'],
          tunes: ['footnotes']
        },
        example_table: ExampleTable,
        // list: {
        //   class: ListTool,
        //   tunes: ['footnotes'], // note that stirng here should be the same as tools object key for Tune
        // },
        paragraph: {
          Îtunes: ['footnotes'], // note that stirng here should be the same as tools object key for Tune
        },
        footnotes: {
          class: FootnotesTune,
        },
      },
      data: {
        time: 1552744582955,
        blocks: [{
            type: 'paragraph',
            data: {
              text: 'PLACEHOLDER唷～～沒事'
            }
          },
          {
            type: 'paragraph',
            data: {
              text: 'PLACEHOLDER唷～～沒事'
            }
          },
          {
            type: 'paragraph',
            data: {
              text: 'PLACEHOLDER唷～～沒事'
            }
          },
          {
            type: 'paragraph',
            data: {
              text: 'PLACEHOLDER唷～～沒事'
            }
          },
          {
            type: 'paragraph',
            data: {
              text: 'より多く日本の文化に<ruby class="cdx-ruby">触<rt class="cdx-rt">ふ</rt></ruby>れることができました。'
            }
          },
          // {
          //   type: "simple_image",
          //   data: {
          //     url: "https://cdn.pixabay.com/photo/2017/09/01/21/53/blue-2705642_1280.jpg",
          //     caption: 'yoyyo',
          //     withBorder: false,
          //     withBackground: true
          //   }
          // }
        ],
        version: "2.22.2"
      }
    });
    const saveButton = document.getElementById('save-button');
    const output = document.getElementById('output');

    saveButton.addEventListener('click', () => {
      editor.save().then(savedData => {
        output.innerHTML = JSON.stringify(savedData, null, 4);
      })
    })
    document.addEventListener('mouseup', () => {
      let sel = document.getSelection();
      if (sel && sel.anchorNode && sel.anchorNode != document & sel.toString() != "") {
        let a = sel.anchorNode;
        let f = sel.focusNode;
        let r = document.createRange();
        r.setStartBefore(a);
        r.setEndAfter(f);
        // sel.removeAllRanges();
        // sel.addRange(r);
        console.log(r.toString());
      }
    })
  </script>
</body>

</html>